{% extends "layout.html" %}

{% block scripts %}
<script>
  $(() => {
    App.data = {
      type: "finish",
    },

    App.finish();
  });
</script>
{% endblock %}

{% block two_col_sidebar %}
Sidebar
{% endblock %}

{% block content %}
<div class="container">
  <div class="row">
    <div class="col">
      <div class="text">
        <div>
          <b>You have accomplished this tutorial! Now you know how to play otamatone!</b>
        </div>
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col">
      <table class="table">
        <thead>
          <tr>
            <th>Question</th>
            <th>Earned</th>
          </tr>
        </thead>
        <tbody>
          {% for result in results %}
            <tr class="{{ 'table-success' if result.earned == result.weight else 'table-danger' }}">
              <td>
                <a href="#" data-micromodal-trigger="modal-{{ result.id }}">{{ result.title }}</a>
              </td>
              <td>
                <code class="text-dark">
                  {{ result.earned }} / {{ result.weight }}
                </code>
              </td>
            </tr>
          {% endfor %}
          <tr>
            <th>Total</th>
            <th>
              <code class="text-dark">
                {{ score }} / {{ total_score }}
              </code>
            </th>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  {% for result in results %}
    <!--
      Snippet adopted from https://gist.github.com/ghosh/4f94cf497d7090359a5c9f81caf60699
    -->
    <div class="modal micromodal-slide" id="modal-{{ result.id }}" aria-hidden="true">
      <div class="modal__overlay" tabindex="-1" data-micromodal-close>
        <div
          class="container bg-white rounded"
          role="dialog"
          aria-modal="true"
          aria-labelledby="modal-1-title"
        >
          <div class="row mt-2">
            <header class="col d-flex justify-content-between align-items-center">
              <h1 class="" id="modal-1-title">
                {{ result.title }}
              </h1>
              <a
                aria-label="Close modal"
                data-micromodal-close
                href="#!"
              >
                <i class="bi bi-x-lg"></i>
              </a>
            </header>
          </div>
          <main class="mt-2 mb-2" id="modal-1-content">
            <p>{{ result.subtitle }}</p>
            <audio controls>
              <source src="/quiz/clip/{{ result.id }}" type="audio/mpeg">
            </audio>
            <h2>Your Answer</h2>
            <p>{{ result.submission }}</p>
            <h2>Correct Answer</h2>
            <p>{{ result.solution }}</p>
          </main>
          <footer>
            <a
              class="btn btn-primary"
              href="/quiz/{{ result.id }}"
              aria-label="Go to {{ result.title }}"
            >
              Go
            </a>
            <button
              class="btn btn-secondary"
              data-micromodal-close
              aria-label="Close this dialog window"
            >
              Close
            </button>
          </footer>
        </div>
      </div>
    </div>
  {% endfor %}
</div>
{% endblock %}
